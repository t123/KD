@inherits BaseView

<MudElement HtmlTag="div">
    @if (State.Value.TabMapping.ContainsKey(Tab))
    {
        var view = State.Value.TabMapping[Tab];
        var items = view.Items.AsQueryable();

        if (!string.IsNullOrWhiteSpace(SearchText))
        {
            items = items.Where(x => x.Name.Contains(SearchText, StringComparison.InvariantCultureIgnoreCase));
        }

        <GridHeader Label="Namespaces" View="view" OnRefresh="Fetch" OnSearch="PerformSearch" ItemCount="@items.Count()" RefreshTimer="Timer">
        </GridHeader>
        <MudDataGrid Items="items" T="NamespaceViewModel" SortMode="SortMode.Single" RowContextMenuClick="ContextMenuClick" Hover="true" ColumnResizeMode="ResizeMode.Column" FixedHeader="true" Height="@BaseView.TableHeight">
            <Columns>
                <TemplateColumn Title="Name" SortBy="x => x.Name" Sortable="true">
                    <CellTemplate>
                        <button @onclick="@(() => OpenProperties(context.Item))">
                            @context.Item.Name
                        </button>
                    </CellTemplate>
                </TemplateColumn>
                <TemplateColumn Title="Status" SortBy="x => x.Status" Sortable="true">
                    <CellTemplate>
                        <MudText Color="@GetTextIndicatorColor(context.Item.Status)">@context.Item.Status</MudText>
                    </CellTemplate>
                </TemplateColumn>
                <PropertyColumn Property="x => x.Created"></PropertyColumn>
            </Columns>
        </MudDataGrid>
        <MudMenu @ref="_contextMenu" PositionAtCursor="true">
            @if (_contextRow != null)
            {
                <MudMenuItem Icon="@Icons.Material.Outlined.ContentCopy" OnClick="(e) => CopyToClipboard(_contextRow.Name)">Copy @_contextRow.Name</MudMenuItem>
                <MudMenuItem Icon="@Icons.Material.Outlined.Edit" OnClick="(e) => OpenEditor(Tab, _contextRow.Name, _contextRow.Namespace)">Edit @_contextRow.Name</MudMenuItem>
                <MudMenuItem Icon="@Icons.Material.Filled.DeleteForever" IconColor="Color.Error">Delete @_contextRow.Name</MudMenuItem>
            }
        </MudMenu>
    }
</MudElement>